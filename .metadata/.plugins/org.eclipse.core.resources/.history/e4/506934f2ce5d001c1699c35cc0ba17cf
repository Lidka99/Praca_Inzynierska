package application.view;

import java.time.Instant;
import java.time.LocalDate;
import java.time.ZoneId;
import java.util.Date;
import java.util.List;

import application.Main;
import application.model.Schedule;
import application.view.intermediate.Converter;
import application.view.intermediate.RaportGenerator;
import application.view.intermediate.ScheduleIntermediate;
import application.view.intermediate.TimeRaportEntry;
import javafx.fxml.FXML;
import javafx.scene.chart.LineChart;
import javafx.scene.control.Button;
import javafx.scene.control.DatePicker;
import javafx.scene.control.TableView;

public class RaportViewController {

	@FXML
	private Button generateButton;
	@FXML
	private Button exportCSV;
	@FXML
	private DatePicker startDatePicker;
	@FXML
	private DatePicker endDatePicker;
	@FXML
	private TableView raportTableView;
	@FXML
	private LineChart raportChart;

	private Main main;

	List<TimeRaportEntry> raport;

	public void onGenerateButtonCLick() {

		LocalDate localDate = startDatePicker.getValue();
		Instant instant = Instant.from(localDate.atStartOfDay(ZoneId.systemDefault()));
		Date startDate = Date.from(instant);

		LocalDate localDate2 = endDatePicker.getValue();
		Instant instant2 = Instant.from(localDate2.atStartOfDay(ZoneId.systemDefault()));
		Date endDate = Date.from(instant2);

		List<Schedule> schedules = main.getScheduleController().getSchedulesWithArrivalBetween(startDate, endDate);

		List<ScheduleIntermediate> schedulesIntermediate = Converter.convert(schedules);

		raport = RaportGenerator.generateTimeRaport(schedulesIntermediate);

	}
	

	public void onExportCSVButtonCLick() {

	}

	public void setUp() {

	}

	public void setmainapp(Main main) {

		this.main = main;

	}

}
