package application.view;

import java.util.Collections;
import java.util.Date;
import java.util.List;
import java.util.stream.Collectors;

import org.apache.commons.lang3.RandomStringUtils;

import com.password4j.BCryptFunction;
import com.password4j.Hash;
import com.password4j.Password;
import com.password4j.types.BCrypt;

import application.Main;
import application.controller.UsersController;
import application.model.Schedule;
import application.model.Users;
import application.model.Users.Role;
import javafx.collections.ListChangeListener;
import javafx.collections.ListChangeListener.Change;
import javafx.fxml.FXML;

import javafx.scene.control.Button;
import javafx.scene.control.ChoiceBox;
import javafx.scene.control.ComboBox;
import javafx.scene.control.PasswordField;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.TableView.TableViewSelectionModel;
import javafx.scene.control.TextField;
import javafx.scene.control.ToggleButton;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.HBox;

public class ScheduleViewController {

	@FXML
	private TableView scheduleTableView;

	@FXML
	private TextField nameInputField;
	@FXML
	private TextField surnameInputField;
	@FXML
	private TextField usernameInputField;
	@FXML
	private TextField emailInputField;
	@FXML
	private ChoiceBox roleChoiceBox;
	

	private HBox passwordHbox;

	private Users selectedUser;


	private Main main;

	private ListChangeListener<Users> selectionListener;

	
	

	

	public void setUp() {

		// dodawanie kolumny id
		TableColumn<Schedule, Integer> column1 = new TableColumn("Id");
		column1.setCellValueFactory(new PropertyValueFactory("id"));
		scheduleTableView.getColumns().add(column1);

		// dodawanie kolumny data
		TableColumn<Schedule, Date> column2 = new TableColumn("Planowana data przyjazdu");
		column2.setCellValueFactory(new PropertyValueFactory("sheduled_date"));
		scheduleTableView.getColumns().add(column2);

		// dodawanie kolumny nazwisko
		TableColumn<Schedule, Date> column3 = new TableColumn("Data przyjazdu");
		column3.setCellValueFactory(new PropertyValueFactory("arrival_date"));
		scheduleTableView.getColumns().add(column3);

		// dodawanie kolumny username
		TableColumn<Schedule, Date> column4 = new TableColumn("Data wyjazdu");
		column4.setCellValueFactory(new PropertyValueFactory("departure_date"));
		scheduleTableView.getColumns().add(column4);

		// dodawanie kolumny email
		TableColumn<Schedule, String> column5 = new TableColumn("Rodzaj");
		column5.setCellValueFactory(new PropertyValueFactory("type"));
		scheduleTableView.getColumns().add(column5);

		// dodawanie kolumny rola
		TableColumn<Schedule, Integer> column6 = new TableColumn("Id naczepy");
		column6.setCellValueFactory(new PropertyValueFactory("trailer_id"));
		scheduleTableView.getColumns().add(column6);
		
		// dodawanie kolumny rola
		TableColumn<Schedule, Integer> column7 = new TableColumn("Id kierowcy");
		column7.setCellValueFactory(new PropertyValueFactory("driver_id"));
		scheduleTableView.getColumns().add(column7);
		
		// dodawanie kolumny rola
		TableColumn<Schedule, Integer> column8 = new TableColumn("Id auta");
		column8.setCellValueFactory(new PropertyValueFactory("truck_id"));
		scheduleTableView.getColumns().add(column8);
				
		
		

		updateTableView();

		

		

	

		// tworzymy tzw "nas³uchiwacz"

		if (selectionListener == null) {
			selectionListener = new ListChangeListener<Users>() {
				@Override
				public void onChanged(Change<? extends Users> change) {
					if (change.getList() != null && change.getList().size() > 0) {

						onSelectedUser(change.getList().get(0));

					}
				}

			};
		}
		
	}


	private void updateTableView() {

		UsersController controller = main.getUsersController();

		List<Users> AllUsers = controller.getAllUsers();

		scheduleTableView.getItems().clear();

		for (Users user : AllUsers) {

			scheduleTableView.getItems().add(user);
		}
	}

	public void setmainapp(Main main) {

		this.main = main;

	}



}
